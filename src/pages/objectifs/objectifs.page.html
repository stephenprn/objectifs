<ion-content class="noScroll">
  <ion-backdrop (click)="closeFab(fab)" class="fabBackDrop" [ngClass]="{'fabBackDropHidden': !backDrop.displayed}" [style.z-index]="backDrop.active ? '500' : '-999'" [style.opacity]="backDrop.displayed ? '0.26' : '0'"></ion-backdrop>
  <stats-card [objectifs]="objectifsWeek" [stats]="weekStats" (click)="openWeekStats()"></stats-card>
  <ion-slides (ionSlideDidChange)="slideDidChange()" initialSlide="{{nbrDaysDisplayed - 1}}">
    <ion-slide *ngFor="let day of days; trackBy: trackDaysFunction;">
      <h1 (click)="goToDay(day.date)">
        <span *ngIf="day.name">{{day.name}}</span>
        <span *ngIf="!day.name">{{day.dateObject | date: dateFormat}}</span>
      </h1>
      <div *ngIf="day.objectifs.length > 0">
        <progress-bar *ngIf="day.stats != null" [progress]="day.stats.getPropDone()"></progress-bar>
        <ion-card>
          <ion-scroll [style.height]="10 * (day.objectifs.length) + 'vh'" scrollY="true">
            <ion-list>
              <ion-item (click)="showActions(obj)" *ngFor="let obj of day.objectifs; trackBy: trackObjectifsFunction;">
                <ion-icon name="{{categoriesJson[obj.category].icon}}" [ngStyle]="{ color: categoriesJson[obj.category].color }"
                  item-start></ion-icon>
                <div [ngClass]="{'done': obj.done}">
                  {{obj.title}}
                </div>
                <p>
                  <ion-icon name="{{importancesJson[obj.importance].icon}}" [ngStyle]="{ color: importancesJson[obj.importance].color }"></ion-icon>
                  <span *ngIf="obj.description === '' || obj.description == null">
                    Importance {{importancesJson[obj.importance].title}}
                  </span>
                  <span *ngIf="obj.description.length <= limitDescription">
                    {{obj.description}}
                  </span>
                  <span *ngIf="obj.description.length > limitDescription">
                    {{obj.description | slice:0:limitDescription}}...
                  </span>
                </p>
                <ion-badge item-end *ngIf="obj.reportCount != null && obj.reportCount != 0">{{obj.reportCount}}</ion-badge>
              </ion-item>
            </ion-list>
          </ion-scroll>
        </ion-card>
      </div>
      <div *ngIf="day.objectifs.length === 0">
        <ion-card>
          <ion-card-header>
            Aucun objectif pour le moment !
          </ion-card-header>
          <ion-card-content>
            <div>
              Vous n'avez fix√© aucun objectif pour ce jour.
            </div>
            <button class="buttonAddObj" ion-button outline (click)="showAdd()">Ajouter un objectif</button>
          </ion-card-content>
        </ion-card>
      </div>
    </ion-slide>
  </ion-slides>

  <ion-fab right bottom #fab>
    <ion-badge color="danger">{{nbrLater}}</ion-badge>
    <button ion-fab (click)="setBackDrop()">
      <ion-icon name="flag"></ion-icon>
    </button>
    <ion-fab-list side="top">
      <button ion-fab (click)="showAdd($event, fab)">
        <ion-icon name="add"></ion-icon>
      </button>
      <button ion-fab (click)="showAddLater($event, fab)">
        <ion-icon name="time"></ion-icon>
      </button>
      <button ion-fab (click)="showSettings($event, fab)">
        <ion-icon name="settings"></ion-icon>
      </button>
      <button ion-fab (click)="showStats($event, fab)">
        <ion-icon name="trending-up"></ion-icon>
      </button>
    </ion-fab-list>
  </ion-fab>
</ion-content>
